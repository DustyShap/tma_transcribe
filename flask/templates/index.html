<!DOCTYPE html>
<html>
<head>
    <title>Transcription Display</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/TMAflatlogo.png') }}">

</head>
<body onload="highlightSearchTerm('{{ query }}', 'transcriptions')">
    <div class="container">
        <header>
                      <h1><a href="{{ url_for('transcriptions') }}" style="text-decoration: none; color: inherit;">Transcribed Segments</a></h1>
        </header>
                <!-- Search Form -->
        <form id='search_form' action="{{ url_for('search') }}" method="get">
            <input type="text" name="query" placeholder="Search transcriptions...">
            <button type="submit">Search</button>
        </form>
        {% if query %}
            <h2>Search Results for "{{ query }}"</h2>
        {% endif %}
        <section id="transcriptions" class="transcriptions">
            {% if no_results %}
              <p>No results found for your search.</p>
            {% else %}
              {% for transcription in transcriptions %}
                  <div class="transcription">
                      <!-- Display Segment Title -->
                      <h2 class="segment-title" onclick="toggleVisibility('segment{{ loop.index }}')">
                          {{ transcription.segment_title }}
                      </h2>
                      <!-- Display Transcribed Text -->
                      <p id="segment{{ loop.index }}" class="content" style="display: none;">
                          {{ transcription.transcribed_text }}
                      </p>

                      <!-- Display Segment URL -->
                      <a href="{{ transcription.segment_url }}" target="_blank">Link to Original Segment</a><br>
            {% if transcription.segment_summary != 'None' %}
                <a href="javascript:void(0);" onclick="toggleVisibility('summary{{ loop.index }}')">Display AI Summary</a>
                <p id="summary{{ loop.index }}" class="content" style="display: none;">
                    {{ transcription.segment_summary }}
                </p><br>
            {% endif %}
                  </div>
              {% endfor %}
            {% endif %}
        </section>
				<nav aria-label="Page navigation">
					<ul class="pagination">
						{% if query %}
							<!-- Pagination for search results -->
							{% for page_num in range(1, pagination.pages + 1) %}
								<li class="page-item {% if page_num == pagination.page %}active{% endif %}">
									<a class="page-link" href="{{ url_for('search', page=page_num, query=query) }}">{{ page_num }}</a>
								</li>
							{% endfor %}
						{% else %}
							<!-- Pagination for main listing -->
							{% for page_num in range(1, pagination.pages + 1) %}
								<li class="page-item {% if page_num == pagination.page %}active{% endif %}">
									<a class="page-link" href="{{ url_for('transcriptions', page=page_num) }}">{{ page_num }}</a>
								</li>
							{% endfor %}
						{% endif %}
					</ul>
				</nav>
    </div>
    <script src="{{ url_for('static', filename='scripts/scripts.js') }}"></script>
</body>
</html>
